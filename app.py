import streamlit as st
import numpy as np
import matplotlib.pyplot as plt
import pandas as pd
import random
import time
from streamlit_gsheets import GSheetsConnection

# -----------------------------------------------------------------------------
# 1. 초기 설정 및 문제 은행
# -----------------------------------------------------------------------------
st.set_page_config(page_title="지진파 정밀 분석 센터", page_icon="🌋", layout="wide")

# 심화 문제 은행 (15문항)
QUIZ_BANK = [
    {"q": "지진의 '규모(Magnitude)'에 대한 설명으로 옳은 것은?", "options": ["관측소마다 다르게 측정된다.", "지진 발생 시 방출된 에너지의 총량이다.", "진원 거리가 멀수록 작아진다.", "진도(Intensity)와 같은 개념이다."], "a": "지진 발생 시 방출된 에너지의 총량이다."},
    {"q": "P파와 S파의 성질에 대한 설명으로 옳은 것은?", "options": ["P파는 고체만 통과한다.", "S파는 액체를 통과할 수 있다.", "P파의 전파 속도가 S파보다 빠르다.", "S파는 종파(Longitudinal wave)이다."], "a": "P파의 전파 속도가 S파보다 빠르다."},
    {"q": "동일한 지진 관측소에서 PS시가 길다는 것은 무엇을 의미하는가?", "options": ["지진의 규모가 크다.", "진원 깊이가 얕다.", "진원까지의 거리가 멀다.", "지반이 단단하다."], "a": "진원까지의 거리가 멀다."},
    {"q": "지구 내부 구조 중 S파가 통과하지 못해 '암영대'를 만드는 층은?", "options": ["맨틀", "외핵", "내핵", "지각"], "a": "외핵"},
    {"q": "세 곳 이상의 관측소에서 진원 거리를 알 때, 진앙을 찾는 방법은?", "options": ["세 원의 교점을 찾는다.", "진폭이 가장 큰 곳을 찾는다.", "PS시가 가장 짧은 곳을 찾는다.", "세 관측소의 중점을 연결한다."], "a": "세 원의 교점을 찾는다."},
    {"q": "해양판과 대륙판이 충돌하는 수렴형 경계에서 주로 발생하는 지진은?", "options": ["천발 지진만 발생한다.", "심발 지진은 발생하지 않는다.", "베니오프대를 따라 천발~심발 지진이 모두 발생한다.", "지진이 거의 발생하지 않는다."], "a": "베니오프대를 따라 천발~심발 지진이 모두 발생한다."},
    {"q": "지진 해일(Tsunami)의 전파 속도에 가장 큰 영향을 미치는 요인은?", "options": ["바람의 세기", "해수면의 온도", "바다의 수심", "달의 인력"], "a": "바다의 수심"},
    {"q": "지진파의 속도가 주변보다 느린 곳(저속도층)은 일반적으로 어떤 상태인가?", "options": ["온도가 높고 밀도가 낮다(부분 용융).", "온도가 낮고 단단하다.", "맨틀 대류의 하강부이다.", "지각의 두께가 얇다."], "a": "온도가 높고 밀도가 낮다(부분 용융)."},
    {"q": "리히터 규모가 1 증가할 때, 지진 에너지는 약 몇 배 증가하는가?", "options": ["10배", "32배", "100배", "1000배"], "a": "32배"},
    {"q": "다음 중 판의 발산형 경계(해령)에서 주로 관측되는 특징은?", "options": ["습곡 산맥 형성", "심발 지진 활발", "새로운 지각 생성 및 천발 지진", "화산 활동 없음"], "a": "새로운 지각 생성 및 천발 지진"},
    {"q": "진원 거리(D)를 구하는 공식으로 가장 적절한 형태는? (k: 비례 상수)", "options": ["D = k * (S파 도착 시간 - P파 도착 시간)", "D = k * (P파 속도 - S파 속도)", "D = k / (S파 도착 시간 - P파 도착 시간)", "D = S파 도착 시간 + P파 도착 시간"], "a": "D = k * (S파 도착 시간 - P파 도착 시간)"},
    {"q": "지진계에 기록된 진폭이 클수록 값이 커지는 척도는?", "options": ["규모(Magnitude)", "진도(Intensity)", "PS시", "주기"], "a": "진도(Intensity)"},
    {"q": "우리나라와 같이 판의 내부에 위치한 지역에서 발생하는 지진의 특징은?", "options": ["주로 심발 지진이다.", "단층 활동과 무관하다.", "판 경계보다 지진 발생 빈도가 낮다.", "규모 8.0 이상의 대지진이 자주 발생한다."], "a": "판 경계보다 지진 발생 빈도가 낮다."},
    {"q": "맨틀과 외핵의 경계면인 구텐베르크 불연속면에서 지진파의 변화는?", "options": ["P파 속도 급증, S파 소멸", "P파 속도 급감, S파 소멸", "P파, S파 모두 속도 증가", "변화 없음"], "a": "P파 속도 급감, S파 소멸"},
    {"q":
